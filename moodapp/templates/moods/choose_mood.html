<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choisir une humeur</title>
</head>
<body>
    <form method="POST" action="{% url 'add_user_mood' %}">
        {% csrf_token %}
        <h3>Choisissez votre humeur :</h3>
        {% for mood in moods %}
            <div>
                <input type="radio" id="mood_{{ mood.id }}" name="mood_id" value="{{ mood.id }}">
                <label for="mood_{{ mood.id }}">{{ mood.name }}</label>
            </div>
        {% endfor %}
        <button type="submit">Enregistrer</button>
    </form>
    

    <script>
        // Récupérer les humeurs disponibles
        fetch('/moods/')
            .then(response => response.json())
            .then(data => {
                const moodSelect = document.getElementById('moodSelect');
                data.forEach(mood => {
                    const option = document.createElement('option');
                    option.value = mood.id;
                    option.textContent = mood.name;
                    moodSelect.appendChild(option);
                });
            });

        // Enregistrer l'humeur
        document.getElementById('moodForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);

            fetch('/moods/add/', {
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}',
                },
                body: formData,
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>

